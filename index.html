<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WPM Quiz - 100 Words</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  #text { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; background: #f9f9f9; }
  #controls { margin: 20px 0; }
  #questions { margin-top: 20px; }
  label { cursor: pointer; display: block; margin-bottom: 5px; }
</style>
</head>
<body>

<h2>Reading WPM Quiz (100 Words)</h2>

<div id="text">
Learning a new language can be both exciting and challenging. Many students find that practicing reading, writing, listening, and speaking every day helps them improve faster. One effective strategy is to read short stories or articles in the target language, paying attention to new vocabulary and sentence structures. Additionally, speaking with native speakers or using language exchange apps can greatly enhance pronunciation and fluency. It is important to review mistakes, learn from them, and remain consistent with daily practice. Over time, learners notice significant improvements in comprehension and communication skills.
</div>

<div id="controls">
  <button onclick="startReading()">▶ Start</button>
  <button onclick="finishReading()">⏹ Finish</button>
</div>

<div id="questions">
  <h3>Quiz Question</h3>
  <label>Which of the following are mentioned as effective strategies to improve language skills? (Select all that apply)</label>
  <label><input type="checkbox" class="q1" value="a"> Reading short stories or articles</label>
  <label><input type="checkbox" class="q1" value="b"> Watching TV</label>
  <label><input type="checkbox" class="q1" value="c"> Speaking with native speakers</label>
  <label><input type="checkbox" class="q1" value="d"> Sleeping</label>
</div>

<div id="result"></div>

<script>
let startTime;
let wordCount = 0;

function startReading() {
  const text = document.getElementById("text").innerText.trim();
  wordCount = text.split(/\s+/).length;
  startTime = Date.now();
  document.getElementById("result").innerText = "Reading started...";
}

function finishReading() {
  if (!startTime) return alert("Please start reading first!");
  const elapsedSec = (Date.now() - startTime) / 1000;
  const safeElapsed = Math.max(elapsedSec, 1); // 0秒回避

  // 正答の配列
  const correctAnswers = ["a", "c"];

  // 選択されたチェックボックスを取得
  const checked = Array.from(document.querySelectorAll(".q1:checked")).map(el => el.value);

  // 正答数と間違い数を計算
  const numCorrect = checked.filter(val => correctAnswers.includes(val)).length;
  const numIncorrect = checked.filter(val => !correctAnswers.includes(val)).length;

  // 正答率計算（間違い選択肢でペナルティ）
  let accuracy = (numCorrect - numIncorrect) / correctAnswers.length;
  if (accuracy < 0) accuracy = 0; // マイナスにならないように調整

  const rawWPM = (wordCount / safeElapsed) * 60;
  const finalWPM = Math.round(rawWPM * accuracy);

  document.getElementById("result").innerHTML =
    `Time: ${elapsedSec.toFixed(1)} sec<br>` +
    `Raw WPM: ${rawWPM.toFixed(1)}<br>` +
    `Accuracy: ${(accuracy*100).toFixed(0)}%<br>` +
    `Final WPM (accuracy applied): ${finalWPM}`;
}
</script>

</body>
</html>
